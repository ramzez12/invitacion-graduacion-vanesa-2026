---
// Calendario.astro - CON CONFIGURACIÃ“N FÃCIL
---

<section class="py-8 px-6 sm:px-8 md:px-12 lg:px-16">
  <div class="max-w-3xl mx-auto relative">
    
    <!-- CONTENEDOR DEL CALENDARIO -->
    <div class="max-w-xl mx-auto px-4 relative">
      
      <!-- FLORES LATERALES IZQUIERDA - MÃS HACIA EL BORDE -->
      <div class="absolute -left-8 md:-left-16 lg:-left-20 top-24 md:top-28 w-16 md:w-32 lg:w-40 pointer-events-none z-0" id="flores-cal-izq">
        <img src="/imagenes/FlorLateral.webp" alt="Flores" class="w-12 h-auto object-contain scale-x-[-1]" />
      </div>

      <!-- FLORES LATERALES DERECHA - MÃS HACIA EL BORDE -->
      <div class="absolute -right-8 md:-right-16 lg:-right-20 top-24 md:top-28 w-12 md:w-32 lg:w-40 pointer-events-none z-0" id="flores-cal-der">
        <img src="/imagenes/FlorLateral.webp" alt="Flores" class="w-12 h-auto object-contain" />
      </div>

      <div class="bg-white rounded-3xl shadow-lg border-2 border-[#a27735] p-4 md:p-8 relative z-10" id="calendario-card">
        
        <!-- MARIPOSAS + TÃTULO DEL MES -->
        <div class="flex items-center justify-center gap-4 md:gap-6 mb-6" id="titulo-mes-container">
          <!-- Mariposa izquierda -->
          <div id="mariposa-cal-izq">
            <img src="/gif/MariposaRoja.gif" alt="Mariposa" class="w-10 h-10 md:w-14 md:h-14 object-contain" />
          </div>

          <!-- TÃ­tulo -->
          <h3 class="font-charm text-3xl md:text-4xl text-[#a27735] font-bold" id="nombre-mes">
            <!-- Se llenarÃ¡ con JavaScript -->
          </h3>

          <!-- Mariposa derecha -->
          <div id="mariposa-cal-der">
            <img src="/gif/MariposaRoja.gif" alt="Mariposa" class="w-10 h-10 md:w-14 md:h-14 object-contain scale-x-[-1]" />
          </div>
        </div>

        <!-- DÃAS DE LA SEMANA -->
        <div class="grid grid-cols-7 gap-1 md:gap-2 mb-3">
          <div class="text-center font-charm text-sm md:text-base text-[#991B1B] font-bold">D</div>
          <div class="text-center font-charm text-sm md:text-base text-[#991B1B] font-bold">L</div>
          <div class="text-center font-charm text-sm md:text-base text-[#991B1B] font-bold">M</div>
          <div class="text-center font-charm text-sm md:text-base text-[#991B1B] font-bold">M</div>
          <div class="text-center font-charm text-sm md:text-base text-[#991B1B] font-bold">J</div>
          <div class="text-center font-charm text-sm md:text-base text-[#991B1B] font-bold">V</div>
          <div class="text-center font-charm text-sm md:text-base text-[#991B1B] font-bold">S</div>
        </div>

        <!-- DÃAS DEL MES -->
        <div class="grid grid-cols-7 gap-1 md:gap-2" id="dias-container">
          <!-- Se llenarÃ¡ con JavaScript -->
        </div>

      </div>
    </div>
  </div>
</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // â­ CONFIGURACIÃ“N DE LA FECHA DE LA BODA â­
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ”§ EDITA ESTAS 3 VARIABLES PARA CAMBIAR LA FECHA:
  
  const DIA_ESPECIAL = 3;       // â† DÃ­a de la boda (1-31)
  const MES_ESPECIAL = 1;        // â† Mes de la boda (1-12)
  const AÃ‘O_ESPECIAL = 2026;     // â† AÃ±o de la boda
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  // Nombres de los meses
  const NOMBRES_MESES = [
    'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
    'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
  ];

  // FunciÃ³n para generar el calendario
  function generarCalendario() {
    const nombreMes = `${NOMBRES_MESES[MES_ESPECIAL - 1]} ${AÃ‘O_ESPECIAL}`;
    document.getElementById('nombre-mes').textContent = nombreMes;

    // Calcular el primer dÃ­a del mes (0 = domingo, 1 = lunes, etc.)
    const primerDia = new Date(AÃ‘O_ESPECIAL, MES_ESPECIAL - 1, 1).getDay();
    
    // Calcular el Ãºltimo dÃ­a del mes
    const ultimoDia = new Date(AÃ‘O_ESPECIAL, MES_ESPECIAL, 0).getDate();

    const diasContainer = document.getElementById('dias-container');
    diasContainer.innerHTML = '';

    // Agregar espacios vacÃ­os para dÃ­as antes del primer dÃ­a del mes
    for (let i = 0; i < primerDia; i++) {
      const espacioVacio = document.createElement('div');
      diasContainer.appendChild(espacioVacio);
    }

    // Agregar los dÃ­as del mes
    for (let dia = 1; dia <= ultimoDia; dia++) {
      const diaDiv = document.createElement('div');
      
      if (dia === DIA_ESPECIAL) {
        // DÃ­a especial de la boda
        diaDiv.className = 'aspect-square flex items-center justify-center rounded-lg bg-gradient-to-br from-[#a27735] to-[#c9a55e] shadow-xl dia-calendario';
        diaDiv.id = 'dia-especial';
        diaDiv.innerHTML = `<span class="font-charm text-2xl md:text-3xl text-white font-bold">${dia}</span>`;
      } else {
        // DÃ­as normales
        diaDiv.className = 'aspect-square flex items-center justify-center rounded-lg hover:bg-[#a27735]/10 transition-all dia-calendario';
        diaDiv.innerHTML = `<span class="font-charm text-base md:text-lg text-gray-600">${dia}</span>`;
      }
      
      diasContainer.appendChild(diaDiv);
    }
  }

  if (typeof window !== 'undefined') {
    document.addEventListener("DOMContentLoaded", () => {
      console.log("ğŸ“… Iniciando animaciones del calendario elegante...");

      // Generar el calendario
      generarCalendario();

      // ğŸ¯ ESTADO INICIAL - FLORES EMPIEZAN MÃS ADENTRO PARA DESLIZARSE MÃS LEJOS
      gsap.set("#flores-cal-izq", { opacity: 0, x: 60 });
      gsap.set("#flores-cal-der", { opacity: 0, x: -60 });
      gsap.set("#calendario-card", { opacity: 0, scale: 0.95 });
      gsap.set("#mariposa-cal-izq", { opacity: 0, x: -20 });
      gsap.set("#mariposa-cal-der", { opacity: 0, x: 20 });
      gsap.set("#titulo-mes-container h3", { opacity: 0 });
      gsap.set(".dia-calendario", { opacity: 0 });

      // âœ¨ ANIMACIÃ“N EN DOS FASES
      ScrollTrigger.create({
        trigger: "#calendario-card",
        start: "top 85%",
        end: "top 20%",
        onEnter: () => animarCalendario(),
        onLeaveBack: () => ocultarCalendario(),
      });

      function animarCalendario() {
        const tl = gsap.timeline();

        // FASE 1: Calendario, mariposas, tÃ­tulo y nÃºmeros aparecen JUNTOS Y RÃPIDO (0.6 seg)
        tl.to("#calendario-card, #mariposa-cal-izq, #mariposa-cal-der, #titulo-mes-container h3, .dia-calendario", {
          opacity: 1,
          scale: 1,
          x: 0,
          duration: 0.6,
          ease: "power2.out",
        })

        // FASE 2: Flores se deslizan MÃS LEJOS HACIA LOS BORDES (0.8 seg)
        .to("#flores-cal-izq, #flores-cal-der", {
          opacity: 1,
          x: 0,
          duration: 0.8,
          ease: "power2.out",
        }, "-=0.2");
      }

      function ocultarCalendario() {
        gsap.set("#flores-cal-izq", { opacity: 0, x: 60 });
        gsap.set("#flores-cal-der", { opacity: 0, x: -60 });
        gsap.set("#calendario-card", { opacity: 0, scale: 0.95 });
        gsap.set("#mariposa-cal-izq", { opacity: 0, x: -20 });
        gsap.set("#mariposa-cal-der", { opacity: 0, x: 20 });
        gsap.set("#titulo-mes-container h3", { opacity: 0 });
        gsap.set(".dia-calendario", { opacity: 0 });
      }

      // ğŸ¦‹ FLOTADO SUAVE DE MARIPOSAS
      gsap.to("#mariposa-cal-izq", {
        y: -8,
        duration: 3,
        ease: "sine.inOut",
        yoyo: true,
        repeat: -1,
        delay: 1,
      });

      gsap.to("#mariposa-cal-der", {
        y: -8,
        duration: 3,
        ease: "sine.inOut",
        yoyo: true,
        repeat: -1,
        delay: 1.2,
      });

      // â­ PULSO MUY SUAVE DEL DÃA ESPECIAL
      gsap.to("#dia-especial", {
        scale: 1.03,
        duration: 3,
        ease: "sine.inOut",
        yoyo: true,
        repeat: -1,
        delay: 1.5,
      });

      console.log("ğŸ“…âœ¨ Â¡Calendario elegante listo!");
    });
  }
</script>

<style>
  #dia-especial {
    box-shadow: 0 6px 20px rgba(162, 119, 53, 0.5);
  }
</style>